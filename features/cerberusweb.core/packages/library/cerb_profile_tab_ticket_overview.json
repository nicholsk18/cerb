{
  "package": {
    "name": "Profile Tab: Ticket Overview",
    "revision": 2,
    "requires": {
      "cerb_version": "10.4.0",
      "plugins": [

      ]
    },
    "library": {
      "name": "Overview",
      "uri": "cerb_profile_tab_ticket_overview",
      "description": "The default overview for ticket records",
      "point": "profile_tab:ticket",
      "image": ""
    },
    "configure": {
      "placeholders": [

      ],
      "prompts": [
      ]
    }
  },
  "records": [
    {
        "uid": "profile_tab_overview",
        "_context": "profile_tab",
        "name": "Overview",
        "context": "ticket",
        "extension_id": "cerb.profile.tab.dashboard",
        "extension_params": {
        	"layout": "sidebar_right"
        }
    },
    {
        "uid": "profile_widget_convo",
        "_context": "profile_widget",
        "name": "Conversation",
        "extension_id": "cerb.profile.tab.widget.ticket.convo",
        "profile_tab_id": "{{{uid.profile_tab_overview}}}",
        "pos": 1,
        "width_units": 4,
        "zone": "content",
        "extension_params": []
    },
    {
      "uid": "widget_ticket_status",
      "_context": "profile_widget",
      "name": "Status",
      "profile_tab_id": "{{{uid.profile_tab_overview}}}",
      "pos": 1,
      "width_units": 4,
      "zone": "sidebar",
      "extension_id": "cerb.profile.tab.widget.sheet",
      "extension_params": {
        "data_query": "type:worklist.records\r\nof:ticket\r\nquery:(\r\n  id:{{record_id}}\r\n  limit:1\r\n  sort:[id]\r\n)\r\nformat:dictionaries",
        "cache_secs": "",
        "placeholder_simulator_kata": "",
        "sheet_kata": "layout:\n  style: fieldsets\n  headings@bool: no\n  paging@bool: no\n  title_column: image\n  colors:\n    labels@csv: #898989, #646464\n    labels_dark@csv: #898989, #cccccc\n    statuses@csv: #66aa57, #5585cc, #636363, #d3352a\n\ncolumns:\n  icon/image:\n    params:\n      record_uri@raw: cerb:group:{{group_id}}\n      text_size@raw: 400%\n  \n  card/group__label:\n    params:\n      bold@bool: yes\n      underline@bool: no\n      text_size: 135%\n      text_color@raw: labels:0\n  \n  card/bucket__label:\n    params:\n      bold@bool: yes\n      underline@bool: no\n      text_color@raw: labels:1\n      text_size: 200%\n  \n  text/status:\n    params:\n      bold@bool: yes\n      text_size: 145%\n      value_template@raw:\n        {{status|capitalize}}\n        {% if reopen_date and status in ['waiting','closed'] %}\n        (<abbr title=\"{{reopen_date|date('r')}}\">{{reopen_date|date_pretty}}</abbr>)\n        {% endif %}        \n      text_color@raw: statuses:{{status_id}}\n  \n  toolbar/actions:\n    label: Actions\n    params:\n      kata:\n        interaction/reopen:\n          uri: cerb:automation:cerb.ticket.status\n          hidden@raw,bool: {{not cerb_record_writeable('ticket', id) or 'open' == status}}\n          label: Re-open\n          icon: upload\n          inputs:\n            ticket@raw: {{id}}\n            #confirm@bool: yes\n            status: open\n        interaction/move:\n          uri: cerb:automation:cerb.ticket.move\n          hidden@raw,bool: {{not cerb_record_writeable('ticket', id)}}\n          label: Move\n          icon: send\n          keyboard: M\n          inputs:\n            ticket@raw: {{id}}\n        menu/waiting:\n          hidden@raw,bool: {{not cerb_record_writeable('ticket', id) or 'open' != status}}\n          label: Waiting\n          icon: clock\n          items:\n            interaction/waiting1h:\n              uri: cerb:automation:cerb.ticket.status\n              label: 1 hour\n              inputs:\n                ticket@raw: {{id}}\n                status: waiting\n                reopen_at: 1 hour\n            interaction/waiting1d:\n              uri: cerb:automation:cerb.ticket.status\n              label: Tomorrow 8am\n              inputs:\n                ticket@raw: {{id}}\n                status: waiting\n                reopen_at: tomorrow 8am\n            interaction/waitingNextWeek:\n              uri: cerb:automation:cerb.ticket.status\n              label: Next week\n              inputs:\n                ticket@raw: {{id}}\n                status: waiting\n                reopen_at: next Monday 8am\n            interaction/waitingUntilReply:\n              uri: cerb:automation:cerb.ticket.status\n              label: Until reply\n              inputs:\n                ticket@raw: {{id}}\n                status: waiting\n        interaction/close:\n          uri: cerb:automation:cerb.ticket.status\n          hidden@raw,bool:\n            {{\n              not cerb_record_writeable('ticket', id) \n              or status in ['closed','deleted']\n            }}\n          label: Close\n          icon: circle-ok\n          keyboard: C\n          inputs:\n            ticket@raw: {{id}}\n            #confirm@bool: yes\n            status: closed\n        interaction/delete:\n          uri: cerb:automation:cerb.ticket.status\n          hidden@raw,bool:\n            {{\n              not cerb_record_writeable('ticket', id) \n              or 'deleted' == status \n              or not cerb_has_priv('contexts.cerberusweb.contexts.ticket.delete')\n            }}\n          label: Delete\n          icon: circle-remove\n          keyboard: X\n          inputs:\n            ticket@raw: {{id}}\n            confirm@bool: yes\n            status: deleted",
        "toolbar_kata": ""
      }
    },
    {
      "uid": "profile_widget_owner",
      "_context": "profile_widget",
      "name": "Owner",
      "extension_id": "cerb.profile.tab.widget.sheet",
      "profile_tab_id": "{{{uid.profile_tab_overview}}}",
      "pos": 2,
      "width_units": 4,
      "zone": "sidebar",
      "extension_params": {
        "data_query": "type:worklist.records\r\nof:ticket\r\nexpand:[owner_]\r\nquery:(\r\n  id:{{record_id}}\r\n  limit:1\r\n  sort:[id]\r\n)\r\nformat:dictionaries",
        "cache_secs": "",
        "placeholder_simulator_kata": "record_id: 6009",
        "sheet_kata": "layout:\r\n  style: fieldsets\r\n  headings@bool: no\r\n  paging@bool: no\r\n  title_column: image\r\n  colors:\r\n    labels@csv: #646464\r\n    labels_dark@csv: #cccccc\r\n\r\ncolumns:\r\n  icon/image:\r\n    params:\r\n      record_uri@raw: cerb:worker:{{owner_id}}\r\n      text_size: 400%\r\n      text_color: labels\r\n\r\n  card/owner__label:\r\n    params:\r\n      image@bool: no\r\n      underline@bool: no\r\n      bold@bool: yes\r\n      text_size: 200%\r\n      text_color: labels\r\n      label_template@raw: {{owner__label|default('(nobody)')}}\r\n  \r\n  text/owner_title:\r\n    params:\r\n      text_color: labels\r\n      \r\n  toolbar/actions:\r\n    params:\r\n      kata:\r\n        interaction/assign:\r\n          uri: cerb:automation:cerb.ticket.assign\r\n          hidden@raw,bool: {{not cerb_record_writeable('ticket',id) or owner_id}}\r\n          label@raw: Assign\r\n          icon: tag\r\n          inputs:\r\n            ticket: {{id}}\r\n        interaction/take:\r\n          uri: cerb:automation:cerb.ticket.assign\r\n          hidden@raw,bool: {{not cerb_record_writeable('ticket',id) or owner_id}}\r\n          label@raw: Take\r\n          icon: user\r\n          keyboard: Shift+T\r\n          inputs:\r\n            ticket: {{id}}\r\n            worker: {{cerb_current_worker().id}}\r\n        interaction/unassign:\r\n          uri: cerb:automation:cerb.ticket.assign\r\n          hidden@raw,bool: {{not cerb_record_writeable('ticket',id) or not owner_id}}\r\n          label@raw: Unassign\r\n          icon: remove\r\n          keyboard: Shift+U\r\n          inputs:\r\n            ticket: {{id}}\r\n            unassign: yes",
        "toolbar_kata": ""
      }
    },
    {
        "uid": "profile_widget_ticket_fields",
        "_context": "profile_widget",
        "name": "Ticket",
        "extension_id": "cerb.profile.tab.widget.fields",
        "profile_tab_id": "{{{uid.profile_tab_overview}}}",
        "pos": 3,
        "width_units": 4,
        "zone": "sidebar",
        "extension_params": {
            "context": "cerberusweb.contexts.ticket",
            "context_id": "{{record_id}}",
            "properties": [
                [
                    "importance",
                    "created",
                    "updated",
                    "closed",
                    "elapsed_response_first",
                    "elapsed_resolution_first",
                    "spam_score",
                    "id"
                ]
            ],
            "links": {
                "show": "1"
            },
            "search": {
                "context": [
                    "cerberusweb.contexts.message",
                    "cerberusweb.contexts.address",
                    "cerberusweb.contexts.ticket",
                    "cerberusweb.contexts.attachment"
                ],
                "label_singular": [
                    "Message",
                    "Participant",
                    "Participant History",
                    "Attachment"
                ],
                "label_plural": [
                    "Messages",
                    "Participants",
                    "Participant History",
                    "Attachments"
                ],
                "query": [
                    "ticket.id:{{record_id}}",
                    "ticket.id:{{record_id}}",
                    "participant.id:[{{record_requesters|keys|join(',')}}] subtotal:status",
                    "on.ticket:(id:{{record_id}}) OR on.message:(ticket.id:{{record_id}}) OR on.comment:(on.ticket:(id:{{record_id}}) OR on.message:(ticket.id:{{record_id}}))"
                ]
            }
        }
    },
    {
        "uid": "profile_widget_org_fields",
        "_context": "profile_widget",
        "name": "Organization",
        "extension_id": "cerb.profile.tab.widget.fields",
        "profile_tab_id": "{{{uid.profile_tab_overview}}}",
        "pos": 4,
        "width_units": 4,
        "zone": "sidebar",
        "extension_params": {
            "context": "cerberusweb.contexts.org",
            "context_id": "{{record_org_id}}",
            "properties": {
                "0": [
                    "_label",
                    "country",
                    "phone"
                ]
            },
            "links": {
                "show": "1"
            },
            "search": {
                "context": [
                    "cerberusweb.contexts.ticket"
                ],
                "label_singular": [
                    "Ticket"
                ],
                "label_plural": [
                    "Tickets"
                ],
                "query": [
                    "org.id:{{record_org_id}}"
                ]
            }
        }
    }
  ]
}
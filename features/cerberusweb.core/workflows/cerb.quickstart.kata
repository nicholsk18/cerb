workflow:
  name: cerb.quickstart
  description: A workspace with a quickstart checklist for initial configuration of Cerb
  requirements:
    cerb_version: >=10.5 <11.0
    cerb_plugins: cerberusweb.core, cerb.project_boards

records:
  task/card_task_welcome:
    fields:
      title: Welcome to Cerb!
      importance: 50
      status: open
  task/card_task_branding:
    fields:
      title: Configure branding
      importance: 50
      status: open
  task/card_task_sender_addys:
    fields:
      title: Configure sender addresses
      importance: 50
      status: open
  task/card_task_email_signatures:
    fields:
      title: Configure email signatures
      importance: 50
      status: open
  task/card_task_mailboxes:
    fields:
      title: Configure mailboxes
      importance: 50
      status: open
  task/card_task_groups:
    fields:
      title: Review groups
      importance: 50
      status: open
  task/card_task_team_members:
    fields:
      title: Invite other team members
      importance: 50
      status: open
  task/card_task_roles:
    fields:
      title: Configure roles
      importance: 50
      status: open
  task/card_task_workspace_home:
    fields:
      title: Create a home workspace
      importance: 50
      status: open
  task/card_task_license:
    fields:
      title: Add your license
      importance: 50
      status: open
  task/card_task_scheduler:
    fields:
      title: Enable the scheduler
      importance: 50
      status: open
  project_board/project_board_checklist:
    fields:
      name: Checklist
      owner__context: app
      owner_id: 0
      cards_kata@raw:
  project_board_column/project_board_checklist_todo:
    fields:
      name: TODO
      board_id: {{records.project_board_checklist.id}}
      pos@int: 0
      cards@list:
        task:{{records.card_task_branding.id}}
        task:{{records.card_task_sender_addys.id}}
        task:{{records.card_task_email_signatures.id}}
        task:{{records.card_task_mailboxes.id}}
        task:{{records.card_task_groups.id}}
        task:{{records.card_task_team_members.id}}
        task:{{records.card_task_roles.id}}
        task:{{records.card_task_workspace_home.id}}
        task:{{records.card_task_license.id}}
        task:{{records.card_task_scheduler.id}}
      cards_kata@raw:
        automation/todo:
          uri: cerb:automation:cerb.projectBoard.card.sheet
          disabled@bool:
            {{card__context is not record type ('task')}}
          inputs:
            sheet:
              layout:
                headings@bool: no
              columns:
                markdown/notes:
                  params:
                    #icon:
                    #  image: right-arrow
                    value_template@raw:
                      {{card__label}}
                      =====
                      Drag this to **In Progress** to start.
  project_board_column/project_board_checklist_in_progress:
    fields:
      name: In Progress
      board_id: {{records.project_board_checklist.id}}
      pos@int: 1
      cards@list:
        task:{{records.card_task_welcome.id}}
      cards_kata@raw:
        automation/progress:
          uri: cerb:automation:cerb.projectBoard.card.sheet
          disabled@bool:
            {{card__context is not record type ('task')}}
          inputs:
            sheet:
              layout:
                headings@bool: no
              columns:
                text/notes:
                  label: Notes
                  params:
                    value_template@ref: cardTemplates

        &cardTemplates@text:
          <h2 style="margin:0 0 5px 0;">{{card__label}}</h2>
          {% set card_templates = {
            "Welcome to Cerb!": "<p>This project board provides a quick checklist for getting Cerb up and running.</p>\n\n<p>Drag cards from the top of the <b>TODO</b> backlog into the <b>In Progress</b> column to work on them. You should limit the in progress cards to only a few at a time.</p>\n\n<p>When you finish a card, drag it from <b>In Progress</b> to <b>Completed!</b>. You'll notice that a bot automatically marks the task completed for you.</p>\n\n<p>This on-boarding workflow was built entirely with Cerb's tools in the browser. You can edit the project board to see how it works (or even make changes).</p>\n\n<p>Drag this card to <b>Completed!</b> <span class=\"glyphicons glyphicons-right-arrow\" style=\"margin-left:5px;\"></span></p>",

            "Configure branding": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li>Navigate to <b>Setup &raquo; Configure &raquo; Branding</b>.</li>\n<li>Upload your logo.</li>\n</ol>",

            "Configure sender addresses": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li><button type=\"button\" class=\"cerb-search-trigger\" data-context=\"cerberusweb.contexts.address\" data-query=\"mailTransport.id:>0\">List sender addresses</button></li>\n<li>Click the <span class=\"glyphicons glyphicons-circle-plus\" style=\"font-size:12px;color:var(--cerb-color-background-contrast-50);\"></span> icon to add new email addresses.</li>\n<li>Add a <button type=\"button\" class=\"cerb-search-trigger\" data-context=\"cerberusweb.contexts.mail.transport\" data-query=\"\">mail transport</button> to an address to enable it as a outgoing sender.</li>\n</ol>",

            "Configure email signatures": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li><button type=\"button\" class=\"cerb-search-trigger\" data-context=\"cerberusweb.contexts.email.signature\" data-query=\"\">List email signatures</button></li>\n<li>Click the <span class=\"glyphicons glyphicons-circle-plus\" style=\"font-size:12px;color:var(--cerb-color-background-contrast-50);\"></span> icon to add new signatures.</li>\n<li>Modify signatures to meet your needs.</li>\n</ol>",

            "Configure mailboxes": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li><button type=\"button\" class=\"cerb-search-trigger\" data-context=\"cerberusweb.contexts.mailbox\" data-query=\"\">List mailboxes</button></li>\n<li>Click the <span class=\"glyphicons glyphicons-circle-plus\" style=\"font-size:12px;color:var(--cerb-color-background-contrast-50);\"></span> icon to add new mailboxes.</li>\n</ol>",

            "Review groups": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li><button type=\"button\" class=\"cerb-search-trigger\" data-context=\"cerberusweb.contexts.group\" data-query=\"\">List groups</button></li>\n<li>Click the <span class=\"glyphicons glyphicons-circle-plus\" style=\"font-size:12px;color:var(--cerb-color-background-contrast-50);\"></span> icon to add new groups.</li>\n<li>Review the mail settings for each group.</li>\n</ol>",

            "Invite other team members": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li><button type=\"button\" class=\"cerb-search-trigger\" data-context=\"cerberusweb.contexts.worker\" data-query=\"\">List workers</button></li>\n<li>Click the <span class=\"glyphicons glyphicons-circle-plus\" style=\"font-size:12px;color:var(--cerb-color-background-contrast-50);\"></span> icon to create new workers.</li>\n</ol>",

            "Configure roles": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li><button type=\"button\" class=\"cerb-search-trigger\" data-context=\"cerberusweb.contexts.role\" data-query=\"\">List roles</button></li>\n<li>Determine the permissions for each role.</li>\n<li>Assign the roles to workers and groups.</li>\n</ol>",

            "Create a home workspace": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li>Click on the <span class=\"glyphicons glyphicons-chevron-down\" style=\"font-size:12px;color:var(--cerb-color-background-contrast-50);\"></span> icon in the top navigation bar.</li>\n<li>Click <b>(+)</b> above the worklist.</li>\n<li>Click <b>Home</b>.</li>\n<li>Click <b>Create</b>.</li>\n</ol>",

            "Add your license": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li><a href=\"https://cerb.ai/pricing/#bot/license.free\" target=\"_blank\" rel=\"noopener\"><b>Request a free 3-seat license</b></a> if you haven't already.</li>\n<li>Install your license in <b>Setup &raquo; Configure &raquo; License</b>.</li>\n</ol>",

            "Enable the scheduler": "<ol style=\"padding:0;margin:0 0 0 20px;\">\n<li>Navigate to <b>Setup &raquo; Configure &raquo; Scheduler</b>.</li>\n<li>Configure the scheduler to run automatically.</li>\n</ol>",
          }%}
          {{card_templates[card__label]}}
  project_board_column/project_board_checklist_completed:
    fields:
      name: Completed!
      board_id: {{records.project_board_checklist.id}}
      pos@int: 2
      cards@list:
      cards_kata@raw:
        automation/done:
          uri: cerb:automation:cerb.projectBoard.card.sheet
          disabled@bool:
            {{card__context is not record type ('task')}}
          inputs:
            sheet:
              layout:
                headings@bool: no
              columns:
                text/notes:
                  label: Notes
                  params:
                    value_template@raw:
                      <h2 style="margin:0 0 5px 0;">
                      <span class="glyphicons glyphicons-circle-ok"></span>
                      {{card__label}}
                      </h2>

      functions_kata@text:
        automation/close:
          uri: cerb:automation:cerb.projectBoard.action.task.close
  workspace_page/workspace_demo:
    fields:
      name: Quickstart
      owner__context: app
      owner_id: 0
      extension_id: core.workspace.page.workspace
  workspace_tab/workspace_tab_eval_checklist:
    fields:
      name: Checklist
      page_id: {{records.workspace_demo.id}}
      pos@int: 0
      extension_id: core.workspace.tab.dashboard
      params:
        layout@text:
  workspace_widget/workspace_widget_checklist_board:
    fields:
      label: Checklist
      extension_id: cerb.workspace.widget.project_board
      tab_id: {{records.workspace_tab_eval_checklist.id}}
      pos@int: 1
      width_units@int: 4
      zone: content
      params:
        project_board_id: {{records.project_board_checklist.id}}
